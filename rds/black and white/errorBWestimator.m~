function [ error ] = errorBWestimator(B, C1, C2, graph, field, numberOfWalks)
%ERRORBWESTIMATOR Summary of this function goes here
%   Detailed explanation goes here

if nargin == 5
    numberOfWalks = 1000;
end

if savedSettings2 == false
    P = transMatrRW(graph);
    initialDistr = degreeDistribution(graph);
    assignin('base', 'initialDistr', initialDistr); 
    assignin('base', 'savedSettings2', true);
    
    responses = zeros(numberOfWalks, numberOfSamples);
    degrees = zeros(numberOfWalks, numberOfSamples);
    for i = 1:numberOfWalks   
        [~,  responses(i, :), degrees(i, :)] = takeSamples(initialDistr, P, numberOfSamples, graph, @propertyForSample, field);
        progress(i, 10);
    end
    
    assignin('base', 'responses', responses); 
    assignin('base', 'degrees', degrees);
    
else
    
    
end



numberOfSamples = floor(B/(C1 + C2));
sumError = 0;
for i = 1:numberOfWalks
    curResponses = responses(1:numberOfSamples); 
    curDegrees   = degrees(
    [~, responses, degrees] = takeSamples(initialDistr, P, numberOfSamples, graph, @propertyForSample, field);
    [~, error] = findProportionOfWhite(curResponses, curDegrees, field);
    sumError = sumError + error;
    progress(i, 20);
end

% result
error = sumError/numberOfWalks;


% P = transMatrRW(graph);
% initialDistr = degreeDistribution(graph);
% numberOfSamples = ceil(B/(C1 + C2));
% 
% sumError = 0;
% for i = 1:numberOfWalks
%     [~, responses, degrees] = takeSamples(initialDistr, P, numberOfSamples, graph, @propertyForSample, field);
%     [~, error] = findProportionOfWhite(responses, degrees, field);
%     sumError = sumError + error;
%     progress(i, 20);
% end
% 
% % result
% error = sumError/numberOfWalks;

end

